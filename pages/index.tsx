import type { NextPage } from 'next'
import Head from 'next/head'
import Image from 'next/image'
import { useEffect, useState } from 'react'
import { Any2 } from '../components/Any2'
// import { Button1 } from '../components/button'
// import { Button2 } from '../components/button/index1'
import { About } from '../components/html-containers/about'
import { AnyKindOfItSolutions } from '../components/html-containers/any-kind-of-it-solutions'
import { Costumer } from '../components/html-containers/custumer'
import { Footer } from '../components/html-containers/footer'
import { Footer2 } from '../components/html-containers/footer2'
import { Header } from '../components/html-containers/header'
import { HeaderBanner } from '../components/html-containers/header-banner'
import { HowWeCanHelp } from '../components/html-containers/how-we-can-help'
import { LatestNewsBlog } from '../components/html-containers/letest-news-blog'
import { OurPricingPlan } from '../components/html-containers/our-pricing-plan'
import { Poppular } from '../components/html-containers/poppular'
import Project from '../components/html-containers/project'
import { RecentProject } from '../components/html-containers/recent-project'
import { Review } from '../components/html-containers/review'

import { fetchAPI } from './api/fetchAPI'

const fields = [
  '*',
  'first_screen.image1',
  'first_screen.image2',
  'how_we_can_help.services',
  'how_we_can_help.services.icon',
  'how_we_can_help.image1',
  'about',
  'about.image',
  'about.Feature',
  'Popular',
  'Popular.Popular',
  'Popular.Popular.image',
  'Awards',
  'recentproject',
  'recentproject.recent',
  'recentproject.recent.image',
  'logo',
  'logo.image',
  'Pricingplan',
  'Pricingplan.Planing',
  'reviews',
  'review.reviews',
  'review.image',
  'review.reviews.profile',
  'latest_news',
  'latest_news.image',
  'latest_news.updates_news',
  'latest_news.updates_news.image',
  'quote',
  'quote.get_a_quote',
]

async function fetchHomepage({ setHomepage }) {
  const homepage = await fetchAPI(
    {
      url: '/api/home-pages',
      params: {
        populate: fields.join(',')
      }
    }
  )
  if (typeof setHomepage === 'function') setHomepage(homepage.data[0].attributes)
  return homepage
}

async function fetchMenu({ setMenu }) {
  const menu = await fetchAPI(
    {
      url: '/api/menus',
      params: {
        populate: '*,menu.submenu'
      }
    }
  )
  if (typeof setMenu === 'function') setMenu(menu.data[0].attributes.menu)
  return menu
}

const Home: NextPage = () => {
  const [homepage, setHomepage] = useState()
  const [menu, setMenu] = useState()

  useEffect(() => {
    fetchHomepage({ setHomepage })
    fetchMenu({ setMenu })
  }, [])

  useEffect(() => {
    
  }, [homepage, menu])



  return (
    <div className="bg-white">
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Header menu={menu}></Header>
      <HeaderBanner data={homepage?.first_screen}></HeaderBanner>
      <HowWeCanHelp data={homepage?.how_we_can_help}></HowWeCanHelp>
      <About data={homepage?.about}></About>
      <Poppular data={homepage?.Popular} ></Poppular>
      <Project data={homepage?.Awards}></Project>
      <RecentProject data={homepage?.recentproject}></RecentProject>
      <Costumer data={homepage?.logo}></Costumer>
      <OurPricingPlan data={homepage?.Pricingplan}></OurPricingPlan>
      <Review data={homepage?.review}></Review>
      <LatestNewsBlog data={homepage?.latest_news}></LatestNewsBlog>
      <AnyKindOfItSolutions data={homepage?.quote}></AnyKindOfItSolutions>
      <Footer></Footer>









    </div >




  )
}

export default Home
